/*!
 * messenger
 * @version: 2.11.7
 * @license: Genesys Cloud Services, Inc.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("__Messenger",[],t):"object"==typeof exports?exports.__Messenger=t():e.__Messenger=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var u=t[o]={i:o,l:!1,exports:{}};return e[o].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)n.d(o,u,function(t){return e[t]}.bind(null,u));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=582)}({13:function(e,t,n){"use strict";n.d(t,"x",(function(){return s})),n.d(t,"v",(function(){return r})),n.d(t,"t",(function(){return i})),n.d(t,"w",(function(){return a})),n.d(t,"k",(function(){return D})),n.d(t,"s",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"y",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return E})),n.d(t,"z",(function(){return g})),n.d(t,"g",(function(){return C})),n.d(t,"q",(function(){return v})),n.d(t,"d",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"e",(function(){return F})),n.d(t,"n",(function(){return y})),n.d(t,"l",(function(){return S})),n.d(t,"o",(function(){return A})),n.d(t,"p",(function(){return k})),n.d(t,"f",(function(){return T})),n.d(t,"m",(function(){return I})),n.d(t,"r",(function(){return w})),n.d(t,"A",(function(){return R})),n.d(t,"u",(function(){return B}));var o=n(19),u=n.n(o);function s(){var e={},t=!1,n=0;"boolean"==typeof(arguments.length<=0?void 0:arguments[0])&&(t=arguments.length<=0?void 0:arguments[0],n++);for(var o=function(n){for(var o in n)n.hasOwnProperty(o)&&(t&&"[object Object]"===Object.prototype.toString.call(n[o])?e[o]=s(e[o],n[o]):e[o]=n[o])};n<arguments.length;n++)o(n<0||arguments.length<=n?void 0:arguments[n]);return e}function r(){var e=!1;return window.screen&&(e=window.screen.width>window.screen.height),e}function i(){var e=!1,t=document.getElementById("full-screen-indicator");window.getComputedStyle&&t&&(e="block"===window.getComputedStyle(t).display);return e}function a(){var e,t=!1,n=!1,o=document.getElementById("full-screen-indicator");window.getComputedStyle&&o?n="block"===window.getComputedStyle(o).display:n=!0;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))&&(t=!0),t&&n}function D(){var e,t,n,o=window.navigator.userAgent,u=window.navigator.platform,s=window.navigator.maxTouchPoints;return/MSIE/.test(o)||/Edge/.test(o)||/Trident\/7\./.test(o)?e="Internet Explorer":/Chrome/.test(o)?(/CrOS/.test(o)&&(u="CrOS"),e="Chrome"):/Opera/.test(o)?e="Opera":/Firefox/.test(o)?e="Firefox":/Safari/.test(o)?(e="Safari",(/iPhone/.test(o)||/iPad/.test(o)||/iPod/.test(o))&&(t="iOS",/FxiOS/.test(o)?e="Firefox":/CriOS/.test(o)&&(e="Chrome"))):/Android/.test(o)&&(e="Android Webkit Browser",(n=/Android\s[\.\d]+/.exec(o)||[]).length&&(t=n[0])),"MacIntel"===u||"MacPPC"===u?t=s&&s>2?"iOS":"Mac OS X":"CrOS"===u?t="ChromeOS":"Win32"===u||"Win64"==u?t="Windows":!t&&/Android/.test(o)?t="Android":!t&&/Linux/.test(u)?t="Linux":!t&&/Windows/.test(o)&&(t="Windows"),{browser:e||"",os:t||""}}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function l(){var e=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage;return e&&"string"==typeof e?e.toLowerCase():""}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2?arguments[2]:void 0;if(0===e)return"0 Bytes";var o=1e3,u=t<0?0:t,s=Math.floor(Math.log(e)/Math.log(o));return(n?Math.round(e/Math.pow(o,s)):parseFloat((e/Math.pow(o,s)).toFixed(u)))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}function p(e,t){var n=e.indexOf(t);return-1!==n&&e.splice(n,1),e}var h={"en-us":"en",cs:"cs",da:"da",de:"de",es:"es",et:"et",fi:"fi",it:"it",ko:"ko",lt:"lt",lv:"lv",nl:"nl",no:"nb",pl:"pl","pt-br":"pt-BR",ru:"ru",sv:"sv",th:"th",tr:"tr","zh-cn":"zh-CN","zh-tw":"zh-TW",fr:"fr",ja:"ja",ar:"ar",he:"he","pt-pt":"pt-PT"},f={"conversations.home":{showHeaderTitle:!0,showHeaderSubTitle:!0,expandHeader:!0,backButton:!1,deleteButton:!1,closeButton:!1,sigInButton:!1,moreVertButton:!1},"conversations.conversations":{showHeaderTitle:!0,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,deleteButton:!0,closeButton:!1,sigInButton:!0,moreVertButton:!0},"knowledge.search":{showHeaderTitle:!1,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,deleteButton:!1,closeButton:!1,sigInButton:!1,moreVertButton:!1},"knowledge.article":{showHeaderTitle:!1,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,deleteButton:!1,closeButton:!1,sigInButton:!1,moreVertButton:!1},"knowledge.category":{showHeaderTitle:!1,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,deleteButton:!1,closeButton:!1,sigInButton:!1,moreVertButton:!1},"conversations.filePreview":{showHeaderTitle:!0,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,deleteButton:!0,closeButton:!1,sigInButton:!0,moreVertButton:!0},"cobrowse.connect":{showHeaderTitle:!0,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,closeButton:!1,sigInButton:!1,moreVertButton:!1},"cobrowse.sharing":{showHeaderTitle:!0,showHeaderSubTitle:!1,expandHeader:!1,backButton:!0,closeButton:!1,sigInButton:!1,moreVertButton:!1}},E=["Genesys","Identifiers","Journey","Engage","Launcher","MessagingService","Cookies","GenesysJS","Messenger","Auth","LocalStorageTest","SupportCenter","Knowledge","KnowledgeService","Home","SubMessenger","ThirdPartyHelper"];function g(e,t){var n={text:e,truncated:!1};return e.length>t&&(n.text=e.slice(0,t)+"...",n.truncated=!0),n}function C(){return/^(\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F|\uD83D\uDC68(?:\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68\uD83C\uDFFB|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|[\u2695\u2696\u2708]\uFE0F|\uD83D[\uDC66\uDC67]|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708])\uFE0F|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C[\uDFFB-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)\uD83C\uDFFB|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB\uDFFC])|\uD83D\uDC69(?:\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFD])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83C\uDFF4\u200D\u2620)\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDF6\uD83C\uDDE6|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDBB\uDDD2-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5\uDEEB\uDEEC\uDEF4-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])\uFE0F?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD]))+$/g}function v(e){return e.storage||"LocalStorage"}function m(e,t){var n="";if("video"===e.toLowerCase())n=document.createElement("video").canPlayType(t);else if("audio"===e.toLowerCase()){n=document.createElement("audio").canPlayType(t)}return n}function b(e){var t=e.split("/"),n=u()(t,2),o=n[0],s=n[1];s&&-1!==s.indexOf("vnd.openxmlformats-officedocument.wordprocessingml.")?s="vnd.openxmlformats-officedocument.wordprocessingml.*":s&&-1!==s.indexOf("vnd.openxmlformats-officedocument.presentationml.")?s="vnd.openxmlformats-officedocument.presentationml.*":s&&-1!==s.indexOf("vnd.openxmlformats-officedocument.spreadsheetml.")&&(s="vnd.openxmlformats-officedocument.spreadsheetml.*");return!(o=o.toLowerCase())||"image"!==o&&"audio"!==o&&"video"!==o&&"text"!==o?s&&"pdf"===s?s.toUpperCase():s&&["vnd.openxmlformats-officedocument.wordprocessingml.*","msword","vnd.google-apps.document","vnd.oasis.opendocument.text","vnd.oasis.opendocument.text-master","application/vnd.oasis.opendocument.text-template"].includes(s)?"Document":s&&["vnd.ms-powerpoint","vnd.openxmlformats-officedocument.presentationml.*","vnd.google-apps.presentation","vnd.oasis.opendocument.presentation","vnd.oasis.opendocument.presentation-template"].includes(s)?"Presentation":s&&["vnd.google-apps.spreadsheet","vnd.ms-excel","vnd.openxmlformats-officedocument.spreadsheetml.*","vnd.oasis.opendocument.spreadsheet","vnd.oasis.opendocument.spreadsheet-template"].includes(s)?"Spreadsheet":"File":o.charAt(0).toUpperCase()+o.slice(1)}function F(e){var t=!1;if(["image/jpeg","image/png","image/gif","image/svg+xml"].includes(e))t=!0;else{var n=document.createElement("canvas");n.width=n.height=1,t=null!==n.toDataURL(e).match(e)}return t}function y(e){var t="",n="",o=e||{},u=o.type,s=o.mime;if(u&&s)t=u,n=s;else if(u){var r=b(u)||"File";t=r&&-1!==["Document","PDF","Presentation","Spreadsheet","Text"].indexOf(r)?"File":r,n=u}return{mediaType:t,mimeType:n}}function S(e){return(e||{}).preview?"":"genesys-mxg-conversation"}function A(e){var t=void 0;return e&&(e.coBrowse?e=e.coBrowse:e.video&&(e=e.video),e.sessionId?t=e.sessionId:e.offeringId&&(t=e.offeringId)),t}function k(e){var t=void 0;return e&&(e.coBrowse||e.sessionJoinToken?t="cobrowse":(e.video||e.offeringId)&&(t="video")),t}function T(e,t){var n=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(t&&"function"==typeof t&&t(),n.disconnect())}))}),{});e&&n.observe(e)}function I(e){return(e||{}).preview?"":"genesys-mxg-homescreen"}function w(e){var t="unknown",n={md:"text/markdown",tsv:"text/tab-separated-values",vcf:"text/vcard",mpa:"audio/MPA"};if(e&&e.length>0){var o=(e=e.toLowerCase()).split(".").pop();o&&o.length>0&&n.hasOwnProperty(o)&&(t=n[o])}return t}function R(e,t){var n=!1;if(e&&t&&e.length>0&&t.length>0){e=e.toLowerCase(),t=t.toLowerCase();var o=e.split(".").pop();o&&o.length>0&&"mpa"===o&&"audio/mpeg"===t&&(n=!0)}return n}function B(){return!!/iP(hone|od)/i.test(window.navigator.userAgent)}},19:function(e,t,n){var o=n(78),u=n(79),s=n(73),r=n(80);e.exports=function(e,t){return o(e)||u(e,t)||s(e,t)||r()},e.exports.__esModule=!0,e.exports.default=e.exports},20:function(e,t,n){"use strict";n.r(t),n.d(t,"SEND_MESSAGE",(function(){return o})),n.d(t,"CONFIGURE_SESSION",(function(){return u})),n.d(t,"GET_CONFIGURATION",(function(){return s})),n.d(t,"CONFIGURE_AUTH_SESSION",(function(){return r})),n.d(t,"DELETE_SESSION",(function(){return i})),n.d(t,"HEALTH_CHECK",(function(){return a})),n.d(t,"PLATFORM",(function(){return D})),n.d(t,"SEND_ECHO",(function(){return c})),n.d(t,"TYPING",(function(){return l})),n.d(t,"DURATION_MS",(function(){return d})),n.d(t,"GET_JWT",(function(){return p})),n.d(t,"UNAUTHORIZED",(function(){return h})),n.d(t,"EXPIRY_SESSIONID_SECS",(function(){return f})),n.d(t,"SEND_ATTACHMENT",(function(){return E})),n.d(t,"GET_ATTACHMENT",(function(){return g})),n.d(t,"DELETE_ATTACHMENT",(function(){return C})),n.d(t,"ATTACHMENT",(function(){return v})),n.d(t,"QUICKREPLY",(function(){return m})),n.d(t,"GENERICTEMPLATE",(function(){return b})),n.d(t,"CARD",(function(){return F})),n.d(t,"CAROUSEL",(function(){return y})),n.d(t,"CAROUSEL_TYPE_CARDS",(function(){return S})),n.d(t,"CONTENT_TYPE_QUICKREPLIES",(function(){return A})),n.d(t,"CONTENT_TYPE_CARD",(function(){return k})),n.d(t,"CONTENT_TYPE_CAROUSEL",(function(){return T})),n.d(t,"FILENAMEINVALID",(function(){return I})),n.d(t,"FILENAMETOOLONG",(function(){return w})),n.d(t,"FILEUPLOADUNAVAILABLE",(function(){return R})),n.d(t,"FILETYPEINVALID",(function(){return B})),n.d(t,"FILETOOLARGE",(function(){return O})),n.d(t,"FILESIZEZERO",(function(){return x})),n.d(t,"FILENOTFOUND",(function(){return M})),n.d(t,"FILECONTENTINVALID",(function(){return N})),n.d(t,"EVENT_UPLOAD_SUCCESS",(function(){return U})),n.d(t,"EVENT_DELETE",(function(){return _})),n.d(t,"MESSAGE_LENGTH_EXCEEDED",(function(){return j})),n.d(t,"CUSTOM_ATTRIBUTES_SIZE_EXCEEDED",(function(){return P})),n.d(t,"CUSTOM_ATTRIBUTES_SIZE_EXCEEDED_MESSAGE",(function(){return L})),n.d(t,"SESSION_EXPIRED",(function(){return W})),n.d(t,"COBROWSE",(function(){return J})),n.d(t,"DISCONNECT_EVENT",(function(){return Q})),n.d(t,"SIGNIN_EVENT",(function(){return H})),n.d(t,"PRESENCE_EVENT_TYPE",(function(){return G})),n.d(t,"DISCONNECT_TYPE_READONLY",(function(){return V})),n.d(t,"JOIN_EVENT",(function(){return z})),n.d(t,"ALLOWED_MIME_TYPE",(function(){return K})),n.d(t,"ALREADY_CONNECTED",(function(){return Y})),n.d(t,"AUTH_SESSION_ALREADY_EXISTS",(function(){return q})),n.d(t,"RATE_LIMIT_EXCEEDED",(function(){return X})),n.d(t,"READ_ONLY_SESSION",(function(){return Z})),n.d(t,"AUTH_FAILED",(function(){return $}));var o="onMessage",u="configureSession",s="getConfiguration",r="configureAuthenticatedSession",i="closeSession",a="healthCheck",D="WebMessaging",c="echo",l="Typing",d=5e3,p="getJwt",h="unauthorized",f=31536e3,E="onAttachment",g="getAttachment",C="deleteAttachment",v="Attachment",m="QuickReply",b="GenericTemplate",F="Card",y="Carousel",S="Cards",A="quick-replies",k="card",T="carousel",I="fileNameInvalid",w="fileNameTooLong",R="FileUploadUnavailable",B="fileTypeInvalid",O="fileTooLarge",x="fileSizeZero",M="FileNotFound",N="fileContentInvalid",U="UploadSuccessEvent",_="AttachmentDeletedResponse",j="messageLengthExceeded",P="customAttributesSizeExceeded",L="customAttributes object is larger than allowed limit:",W="SessionExpired",J="CoBrowse",Q="Disconnect",H="signin",G="Presence",V="readonly",z="Join",K=["image/"],Y="AlreadyConnected",q="authSessionAlreadyExists",X="rateLimitExceeded",Z="readOnlySession",$="authenticationFailed"},254:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},26:function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},27:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},28:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},357:function(e){e.exports=JSON.parse('{"name":"messenger","version":"2.11.7","description":"Genesys Widgets Messenger","private":true,"license":"Genesys Cloud Services, Inc.","scripts":{"lint":"eslint --fix .","format":"prettier --write \\"**/*.+(js|jsx|json|yml|yaml|css|md)\\"","build-middleware":"NODE_ENV=production webpack -p --config webpack.config.dll.js","build-messenger":"NODE_ENV=production webpack -p","build":"npm run build-middleware && npm run build-messenger","start":"webpack-dev-server -d --port 5501 --open \'Google Chrome\'","dev-middleware":"NODE_ENV=development webpack --config webpack.config.dll.js","dev-messenger":"NODE_ENV=development webpack","dev":"npm run dev-middleware && npm run dev-messenger","dev-knowledge":"npm install /Users/rsai/knowledge/messenger-knowledge-components-0.3.0-dev-WEBMESS-805.1.tgz && NODE_ENV=development webpack","start:messenger":"webpack-dev-server -d --web-app-name messenger --host 0.0.0.0 --disable-host-check --port 5555","test:ci":"NODE_ENV=test jest --verbose --detectOpenHandles --testResultsProcessor=\'jest-junit\'","cypress:open":".\\\\src\\\\tests\\\\update-dependencies-dev.sh && npx cypress open","cypress:run":".\\\\src\\\\tests\\\\update-dependencies-dev.sh && npx cypress run","test":".\\\\src\\\\tests\\\\update-cxbus.sh && NODE_ENV=test jest --verbose","report":"mochawesome-merge ./cypress/videos/results/*.json > ./src/tests/reports/report-cypress.json","upload":"upload --web-app-name messenger --version $PACKAGE_VERSION --ecosystem pc --source-dir build --manifest manifest.json","deploy-dev":"deploy --web-app-name messenger --version $PACKAGE_VERSION --ecosystem pc --dest-env dev --manifest manifest.json ","cdn":"cdn --web-app-name messenger --version $PACKAGE_VERSION --ecosystem pc","deploy-prod":"deploy --web-app-name messenger --version $PACKAGE_VERSION --dest-env prod --manifest manifest.json --ecosystem pc","deploy-test":"deploy --web-app-name messenger --version $PACKAGE_VERSION --dest-env test --manifest manifest.json --ecosystem pc"},"jest":{"moduleNameMapper":{"\\\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$":"<rootDir>/src/tools/fileMock.js","\\\\.(css|scss)$":"<rootDir>/src/tools/styleMock.js"},"testMatch":["<rootDir>/src/tests/unit/**.js"],"setupFiles":["<rootDir>/cxbus/cxbus.min.js","<rootDir>/src/tests/genesys-bootstrap/plugins/markdown.min.js"],"setupFilesAfterEnv":["<rootDir>/src/tests/setupTests.js"]},"jest-junit":{"suiteName":"Unit tests","outputDirectory":"./src/tests/reports","outputName":"report-jest.xml","classNameTemplate":"Unit test-{title}","titleTemplate":"Unit test-{title}","usePathForSuiteName":"true"},"dependencies":{"@babel/plugin-transform-runtime":"^7.22.6","@babel/polyfill":"^7.10.4","@emotion/react":"^11.7.0","@emotion/styled":"^11.6.0","@genesys/messenger-knowledge-components":"^0.14.1","@mui/icons-material":"^5.2.0","@mui/lab":"^5.0.0-alpha.100","@mui/material":"^5.2.2","@mui/styles":"^5.2.2","core-js":"^3.6.5","cypress-iframe":"^1.0.1","dayjs":"^1.9.1","dompurify":"^2.4.9","file-saver":"^2.0.5","marked":"^4.0.10","react":"^17.0.0","react-app-polyfill":"^2.0.0","react-dom":"^17.0.0","react-redux":"^7.2.0","redux":"^4.0.5","redux-immutable-state-invariant":"^2.1.0","redux-thunk":"^2.3.0","stylis":"^4.0.10","stylis-plugin-rtl":"^2.1.1","uuid":"^8.3.0","websocket-as-promised":"^1.1.0"},"contributors":[],"repository":{"type":"git","url":"https://bitbucket.org/inindca/widgets.git"},"author":"Genesys Telecom Labs","homepage":"https://bitbucket.org/inindca/widgets#readme","copyright":"Copyright © 2020 Genesys. All rights reserved.","devDependencies":{"@babel/core":"^7.24.9","@babel/plugin-proposal-class-properties":"^7.18.6","@babel/plugin-proposal-decorators":"^7.24.7","@babel/plugin-proposal-object-rest-spread":"^7.20.7","@babel/preset-env":"^7.24.8","@babel/preset-react":"^7.24.7","@cypress/skip-test":"^2.6.1","@mui/utils":"^6.0.0-alpha.9","@svgr/webpack":"^5.4.0","@testing-library/jest-dom":"^5.11.4","@testing-library/react":"^10.4.7","@typescript-eslint/eslint-plugin":"^3.1.0","@typescript-eslint/parser":"^3.1.0","@wojtekmaj/enzyme-adapter-react-17":"^0.6.7","axe-core":"^4.3.3","babel-eslint":"^10.1.0","babel-jest":"^26.1.0","babel-loader":"^8.1.0","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-plugin-transform-react-jsx-source":"^6.22.0","clean-webpack-plugin":"^3.0.0","compression-webpack-plugin":"^4.0.0","copy-webpack-plugin":"^6.0.2","css-loader":"^3.5.3","cypress":"^13.6.1","cypress-file-upload":"^5.0.0","cypress-multi-reporters":"^1.4.0","cypress-plugin-tab":"^1.0.5","cypress-react-selector":"^2.2.0","cypress-wait-until":"^1.7.1","enzyme":"^3.11.0","eslint":"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-config-react-app":"^5.2.1","eslint-plugin-flowtype":"^4.7.0","eslint-plugin-import":"^2.20.2","eslint-plugin-jsx-a11y":"^6.2.3","eslint-plugin-prettier":"^3.1.3","eslint-plugin-react":"^7.20.0","eslint-plugin-react-hooks":"^4.0.4","express":"^4.17.1","file-loader":"^6.0.0","html-loader":"^1.1.0","html-minimizer-webpack-plugin":"^1.0.1","html-webpack-plugin":"^4.3.0","jest":"^26.1.0","jest-junit":"^16.0.0","junit-report-merger":"^4.0.0","mocha-junit-reporter":"^2.0.0","mochawesome":"^7.1.3","mochawesome-merge":"^4.3.0","prettier":"^3.3.3","react-lazily":"^0.9.0","react-test-renderer":"^16.13.1","regenerator-runtime":"^0.13.6","sass":"^1.26.8","sass-loader":"^8.0.2","style-loader":"^1.2.1","terser-webpack-plugin":"^4.1.0","text-loader":"0.0.1","typescript":"^3.9.3","url-loader":"^4.1.0","webpack":"^4.45.0","webpack-bundle-analyzer":"^3.8.0","webpack-cli":"^3.3.11","webpack-dev-server":"^3.11.0"},"browserslist":{"production":[">0.2%","not dead","not op_mini all","ie 10"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version","ie 10"]}}')},443:function(e,t,n){(function(n){var o,u,s;u=[],void 0===(s="function"==typeof(o=function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function o(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){a(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function u(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,n){var i=r.URL||r.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin===location.origin?s(a):u(a.href)?o(e,t,n):s(a,a.target="_blank")):(a.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(a.href)}),4e4),setTimeout((function(){s(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,r),n);else if(u(e))o(e,n,r);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){s(i)}))}}:function(e,t,n,u){if((u=u||open("","_blank"))&&(u.document.title=u.document.body.innerText="downloading..."),"string"==typeof e)return o(e,t,n);var s="application/octet-stream"===e.type,a=/constructor/i.test(r.HTMLElement)||r.safari,D=/CriOS\/[\d]+/.test(navigator.userAgent);if((D||s&&a||i)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=D?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=e:location=e,u=null},c.readAsDataURL(e)}else{var l=r.URL||r.webkitURL,d=l.createObjectURL(e);u?u.location=d:location.href=d,u=null,setTimeout((function(){l.revokeObjectURL(d)}),4e4)}});r.saveAs=a.saveAs=a,e.exports=a})?o.apply(t,u):o)||(e.exports=s)}).call(this,n(254))},582:function(e,t,n){"use strict";n.r(t);var o,u=n(26),s=n.n(u),r=n(27),i=n.n(r),a=n(28),D=n.n(a),c=n(8),l=n.n(c),d=n(443),p=n(13),h=n(357),f=n(20),E=new Uint8Array(16);function g(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(E)}var C=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var v=function(e){return"string"==typeof e&&C.test(e)},m=[],b=0;b<256;++b)m.push((b+256).toString(16).substr(1));var F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase();if(!v(n))throw TypeError("Stringified UUID is invalid");return n};var y=function(e,t,n){var o=(e=e||{}).random||(e.rng||g)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var u=0;u<16;++u)t[n+u]=o[u];return t}return F(o)};function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={init:function(e){k.transport=e},formattedMessage:function(e){var t=e.text,n=e.type,o=e.channel,u=e.direction,s=e.id,r=e.content,i=e.originatingEntity,a=e.events,D=e.metadata,c=e.tracingId,l=(o||{}).from,d=l||{},h=d.nickname,E=d.image,g={from:l||"",text:t,type:n&&"string"==typeof n?n.toLowerCase():"",id:o&&o.messageId?o.messageId:s,time:o&&o.time?o.time:"",timestamp:o&&o.time?o.time:"",files:[],quickReplies:[],card:{},carousel:{cards:[]},coBrowse:{},messageType:u&&"string"==typeof u?u.toLowerCase():"",originatingEntity:i||"",tracingId:c||""},C=(D||{}).readOnly,v=k.transport;return(h||E)&&(g.from.name=h||"",g.from.avatar=E||""),r&&r.length&&r.forEach((function(e){if(e&&e.contentType==f.ATTACHMENT){var t=e.attachment,n=t.fileSize,o=t.fileName,u=t.filename,s=t.url,r=t.mime,i=t.id,a=t.mediaType;g.files.push({downloadUrl:s,size:n,name:o||u,type:a,mime:r,id:i})}if(e&&e.contentType==f.QUICKREPLY){var D=e.quickReply,c=D.id,l=D.text,d=D.payload,h=D.image,E=D.action;g.contentType=f.CONTENT_TYPE_QUICKREPLIES,g.quickReplies.push({id:c||Object(p.s)(),text:l,payload:d,imageUrl:h,action:E})}if(e&&(e.contentType==f.GENERICTEMPLATE||e.contentType==f.CARD)){var C=e.generic||e.card,v=C.id,m=C.title,b=C.description,F=C.image,y=C.actions,S=C.components,A=C.defaultAction||y,k=S||y;g.contentType=f.CONTENT_TYPE_CARD,g.card={id:v||Object(p.s)(),title:m,description:b,imageUrl:F||"",actions:A,buttons:k}}if(e&&e.contentType==f.CAROUSEL){var T=(e.carousel||{}).cards;g.contentType=f.CONTENT_TYPE_CAROUSEL,T&&T.length&&(g.carouselType=f.CAROUSEL_TYPE_CARDS,T.forEach((function(e){var t=e||{},n=t.id,o=t.title,u=t.description,s=t.image,r=t.actions,i=t.defaultAction;g.carousel.cards.push({id:n||Object(p.s)(),title:o,description:u,imageUrl:s||"",actions:i,buttons:r})})))}})),a&&a.length&&a.forEach((function(t){if(t&&t.eventType==f.COBROWSE){var n=t||{},o=n.id,u=n.coBrowse;g.eventType=f.COBROWSE,g.coBrowse=A({id:o||Object(p.s)()},u)}else if(t&&t.eventType==f.PRESENCE_EVENT_TYPE){var s=((t||{}).presence||{}).type;s&&s==f.DISCONNECT_EVENT?(v.bConversationDisconnectEvent=!0,v.onConversationDisconnect({originalData:e,data:{readOnly:C?"true"===C.toLowerCase():void 0}})):s&&s.toLowerCase()===f.SIGNIN_EVENT&&v.onConversationSteppedUp(e),g.eventType=f.PRESENCE_EVENT_TYPE,g.presence={type:s}}})),g},fileReader:function(e){return new Promise((function(t,n){if(e){var o=new FileReader;o.onload=function(e){t(o.result)},o.readAsArrayBuffer(e)}else n()}))},uploadFile:function(e){var t=k.transport,n=(e.attachmentId,e.url),o=e.headers,u=(e.type,new Promise((function(e,u){k.fileReader(t.aUploadQueue[0]).then((function(s){var r=t.aUploadQueue[0]||{},i=r.type,a=r.name,D=!1;if(i&&""!==i){var c=i.toLowerCase();t.aDeprecatedFileTypes.includes(c)?D=!0:t.aDeprecatedFileTypes.includes(c)||(D=Object(p.A)(a,c))}t.uploadRequest({url:n,headers:A(A({},o),{},{"Content-Type":(i&&""!==i&&!D?i:Object(p.r)(a))||"image/png"}),data:s}).then((function(t){e(t)}),(function(e){u(e)})).catch((function(e){u(e)}))}))})));return u},formatMessages:function(e){var t=e.entities,n=k.transport,o=[];return new Promise((function(e,u){t&&t.length?(t.forEach((function(t,u){t.channel&&t.channel.messageId?t.channel.messageId:t.id;var s=t.channel&&t.channel.time?t.channel.time:t.id,r=(t.content&&t.content[0]?t.content[0]:{}).attachment,i="";if(r&&r.id&&(i=r.id),s&&!n.oMessages[s]&&-1===n.aAttachmentIds.indexOf(i)){n.oMessages[s]=t;var a=k.formattedMessage(t);o.push(a),n.aTransformedMessages.push(a)}0==u&&e(o)})),e(o)):e(o)}))},sanitiseMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var n=e||{},o=n||{},u=o.response,s=o.resource,r=o.requestId,i=o.message;s&&(n={body:{message:i||"",requestId:r||""}});var a=u||n||{},D=a.data,c=a.body,l=a.errorKey,d=D||c||u||n||{},p=d.message,h=d.errorMessage;t={errorName:d.errorKey||l||"Error",errorMessage:p||h||c||n}}else{var f=e.messageType,E=e.time,g=e.channel,C=e.direction,v=e.originatingEntity,m=e.type,b=E||(g?g.time:null);t={id:e.id,direction:f||C,originatingEntity:v,type:m,time:b}}return t},parseTranscript:function(e,t,n,o){var u=k.transport;(u.config||{}).allowSessionUpgrade;if(e&&Object.keys(e).length&&!n){var s=e,r=s.attachmentId,i=s.url,a=s.downloadUrl,D=s.timestamp,c=s.headers,l=(s.type,s.direction),d=s.channel,h=s.id,E=s.content,g=s.events,C=s.metadata,v=c&&!!Object.keys(c).length,m=u.aTransformedMessages.length?u.aTransformedMessages[u.aTransformedMessages.length-1]:"",b=(d&&d.messageId&&d.messageId,d&&d.time?d.time:h);C&&C.id&&C.id;if(m&&t&&t!=f.TYPING&&l&&"Outbound"==l&&d&&d.time)new Date(d.time).getTime()<new Date(m.time).getTime()&&u.onOutofOrderMessageReceived({message:k.sanitiseMessage(e),previousMessage:k.sanitiseMessage(m)});if((r||i)&&v){var F={attachmentId:r,headers:c,uploadURL:i};u.aUploadQueue[0]&&(u.aUploadQueue[0].id=r),u.onUploadApproved(F),k.uploadFile(e).then((function(e){}),(function(e){u.onFileUploadFailed(e)}))}if(r&&i&&!v)if(-1!==u.aGetFileQueue.indexOf(r)){var y=u.aTransformedMessages.filter((function(e,t){var n=JSON.parse(JSON.stringify(e));if(n.files&&n.files[0]&&n.files[0].downloadUrl)return n.files[0].id==r&&(u.aGetFileQueue=[]),n}));y&&-1!==u.aGetFileQueue.indexOf(r)&&(u.aGetFileQueue=[]),y=y.map((function(e){var t=JSON.parse(JSON.stringify(e));return t.files[0].id===r&&(t.files[0].downloadUrl=i,t.files[0].updatedTime=(new Date).toISOString()),t.updatedTime=(new Date).toISOString(),A({},t)}));var S={viewFiles:{attachmentId:r,newDownloadUrl:i,updatedTime:(new Date).toISOString()},updatedMessages:y};u.onMessagesUpdated(S),u.onFileReceived({downloadUrl:i,attachmentId:r,timestamp:D})}else if(-1!==u.aRefreshFilesQueue.indexOf(r)){var T=u.aTransformedMessages.filter((function(e,t){var n=JSON.parse(JSON.stringify(e));if(n.files&&n.files[0]&&n.files[0].downloadUrl)return n.files[0].id==r&&(n.files[0].downloadUrl=i,u.aRefreshFilesQueue=Object(p.y)(u.aRefreshFilesQueue,r)),n}));u.onMessagesUpdated({updatedMessages:T})}t==f.EVENT_UPLOAD_SUCCESS&&a?(u.sAttachmentId=r,u.onFileUploaded({downloadUrl:a,attachmentId:r,timestamp:D})):t==f.EVENT_DELETE&&r?-1!==u.aDeleteFileQueue.indexOf(r)&&(Object(p.y)(u.aDeleteFileQueue,r),u.onFileDeleted({attachmentId:r})):g&&g.length?g.forEach((function(t){var n=t||{},o=n.eventType,s=n.typing;if(s&&o&&o==f.TYPING){if("outbound"===l.toLowerCase()){var r=s.duration,i=s.durationMs,a=r||i||f.DURATION_MS;u.clearTypingTimeout(),u.bAgentTypingTimeout=setTimeout((function(){u.clearTypingTimeout(),u.onTypingTimeout()}),a),u.onTypingReceived({typing:s})}}else if(o&&(o==f.COBROWSE||o==f.PRESENCE_EVENT_TYPE)){if(b&&!u.oMessages[b]&&(o==f.PRESENCE_EVENT_TYPE&&(u.sAttachmentId="",u.aUploadQueue=[]),u.oMessages[b]=e,e=k.formattedMessage(e),u.aTransformedMessages.push(e),u.onMessageReceived({messages:e,originalMessages:[u.oMessages[b]]})),Array.isArray(e.events)&&e.events.length&&e.events[0].presence)(e.events[0].presence||{}).type.toLowerCase()===f.SIGNIN_EVENT&&(e=k.formattedMessage(e),u.aTransformedMessages.push(e),u.onMessageReceived({messages:e,originalMessages:[u.oMessages[b]]}))}})):(E&&E.length&&E.forEach((function(e){var t=e.contentType,n=e.attachment;n&&t&&t==f.ATTACHMENT&&u.sAttachmentId==n.id&&(u.sAttachmentId="",u.aAttachmentIds.push(n.id),u.aUploadQueue=[])})),b&&!u.oMessages[b]&&(u.oMessages[b]=e,e=k.formattedMessage(e),u.aTransformedMessages.push(e),u.onMessageReceived({messages:e,originalMessages:[u.oMessages[b]]})))}if(t)switch(t){case"ConnectionClosedEvent":u.bEnableExponentialTimer&&(u.healthCheckIntervalTimer=32e3),u.bConnectionAutoClosed=!0,u.healthCheckInterval&&(clearInterval(u.healthCheckInterval),u.healthCheckInterval=""),u.onConnectionClosed(e),u.pageNumber=1,u.bWebSocket=!1,u.aTransformedMessages=[],u.oMessages={},u.aAttachmentIds=[],u.aUploadQueue=[],u.closeWebSocket({code:-1});break;case"JwtResponse":e&&Object.keys(e).length&&u.pJWTResolve&&u.pJWTResolve(e);break;case"SessionExpiredEvent":u.aUploadQueue=[],u.aTransformedMessages=[],u.oMessages={},u.aAttachmentIds=[],u.oCustomAttributes={},u.bReadyToSendJoinEvent=!1,u.healthCheckInterval&&(clearInterval(u.healthCheckInterval),u.healthCheckInterval=""),u.onSessionExpired({errorKey:f.SESSION_EXPIRED}),k.closeWebSocket();break;case"LogoutEvent":u.bLoggedOutEvent=!0,u.bEnableExponentialTimer&&(u.healthCheckIntervalTimer=32e3),u.healthCheckInterval&&(clearInterval(u.healthCheckInterval),u.healthCheckInterval=""),k.resetConversation(),u.aUploadQueue=[],u.bWebSocket=!1,u.bUpgradedSession=!1,u.closeWebSocket({code:1e3,reason:"logout"});break;case"SessionClearedEvent":k.resetConversation(),u.healthCheckInterval&&(clearInterval(u.healthCheckInterval),u.healthCheckInterval=""),u.bWebSocket=!1,u.bReadyToSendJoinEvent=!1,u.onConversationCleared(o),"function"==typeof u.pClearResolve&&(u.pClearResolve(o),u.pClearResolve="")}},buildHistoryURL:function(){return k.transport.config.apiEndpoint+"/api/v2/webmessaging/messages"},mergeHistoryAndWSMessages:function(e,t){var n=[],o=1===e.length&&1===Object.keys(t).length;e&&e.length?Object.keys(t).forEach((function(u){e.every((function(e){return!(e.timestamp!==u||e.timestamp===u&&o)||(n.push(k.formattedMessage(t[u])),!1)}))})):Object.keys(t).reverse().forEach((function(e){n.push(k.formattedMessage(t[e]))}));return n},restoreRequest:function(e){var t=k.transport;return new Promise((function(n,o){var u=k.buildHistoryURL()+"?pageNumber="+t.pageNumber;t.makeRequest({url:u,method:"get",headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){var o=e.data,u=e.status;u&&200===u&&k.formatMessages(o).then((function(e){var u=e;t.pageNumber++,t.oMessages&&Object.keys(t.oMessages).length&&(u=k.mergeHistoryAndWSMessages(e,t.oMessages)),n({messages:u,pageNumber:o.pageNumber,pageSize:o.pageSize})})).catch((function(){}))})).catch((function(e){var n=((e.response||e).data||"").code;n&&-1!==t.httpJWTExpiryCodes.indexOf(n)?t.bSessionActive&&t.onTokenExpired({code:f.UNAUTHORIZED,commandName:"restore",error:e}):o(e)}))}))},handleErrorr:function(e){var t=k.transport;t.bEnableExponentialTimer&&(t.healthCheckIntervalTimer=32e3,t.healthCheck()),t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)})},resetHealthCheckInterval:function(){var e=k.transport;if(e.healthCheckIntervalTimer<e.maximumTimerThreshold){var t=Math.round(e.healthCheckIntervalTimer*e.healthCheckMultiplier);e.healthCheckIntervalTimer=t<=e.maximumTimerThreshold?t:e.maximumTimerThreshold}else e.healthCheckIntervalTimer=e.maximumTimerThreshold;e.healthCheck()},resetConversation:function(e){var t=k.transport;t.pageNumber=1,t.aTransformedMessages=[],t.oMessages={},t.aAttachmentIds=[],e||(t.aUploadQueue=[])},closeWebSocket:function(){var e=k.transport;e.bCloseSession=!1,e.closeWebSocket({code:1e3,reason:"Close expired session"})},resolveConnectingPromise:function(){var e=k.transport;e.pConnectReject&&(e.pConnectReject(),e.pConnectReject=""),e.pReconnectReject&&(e.pReconnectReject(),e.pReconnectReject="")}};Genesys("registerModule","genesyscloud-messaging-transport",function(){return D()((function e(t,n){var o=this;if(i()(this,e),this.bWebSocket=!1,this.bNewConversation=!1,this.bFetchingConfiguration=!1,this.bRestoring=!1,this.bSessionActive=!1,this.bReconnecting=!1,this.connecting=!1,this.bUploading=!1,this.bClosedUnexpectedly=!1,this.bConnectionAutoClosed=!1,this.bLoggedOutEvent=!1,this.bPresenceEvent=!1,this.bReadyToSendJoinEvent=!1,this.bPendingSendJoinEvent=!1,this.oTempJoinEvent="",this.customSettings="",this.bConversationDisconnectEvent=!1,this.bCloseSession=!1,this.bResetConversation=!1,this.oJourneyContext="",this.aMessageQueue=[],this.oLastMessageSent={},this.oMessages={},this.aAttachmentIds=[],this.aTransformedMessages=[],this.aUploadQueue=[],this.aGetFileQueue=[],this.aDeleteFileQueue=[],this.aRefreshFilesQueue=[],this.aAllowedFileTypes=[],this.maxFileSizeKB="",this.sAttachmentId="",this.config={reservedFields:{},mode:0},this.newRelic=n||{},this.aAuthTokenKeys=["gcatkn","gcartkn"],this.bAuthenticating=!1,this.bAnonymousSession=!1,this.bUpgradingSession=!1,this.bUpgradedSession=!1,this.bPreviousAuthSessionDetected=!1,this.aUnexpectedSocketCloseCodes=[1013,1012,1011,1010,1009,1007,1006,1005,1001],this.aDeprecatedFileTypes=["text/directory","text/x-vcard"],this.errorCodes={4004:f.FILENAMEINVALID,4005:f.FILENAMETOOLONG,4e3:f.FILEUPLOADUNAVAILABLE,4001:f.FILETYPEINVALID,4002:f.FILETOOLARGE,4003:f.FILECONTENTINVALID,4011:f.MESSAGE_LENGTH_EXCEEDED,4102:f.FILESIZEZERO,4013:f.CUSTOM_ATTRIBUTES_SIZE_EXCEEDED,4016:f.AUTH_SESSION_ALREADY_EXISTS,429:f.RATE_LIMIT_EXCEEDED,409:f.READ_ONLY_SESSION,403:f.AUTH_FAILED},this.httpSessionErrorCodes=["not.found","session.not.found","session.expired"],this.httpJWTExpiryCodes=["not.authorized","unauthorized"],this.pageNumber=1,this.constants=f,this.maxMessageSize=4093,this.newRelic){var u=(this.newRelic||{}).performanceMetrics;this.nRMessengerPerformanceMetrics=u}t&&"object"==s()(t)&&this.configure(t),this.pConnectResolve="",this.pConnectReject="",this.pReconnectResolve="",this.pReconnectReject="",this.pResetResolve="",this.pResetReject="",this.pRestoreConnectResolve="",this.pAuthRestoreConnectResolve="",this.bRestoreConnectPending=!1,this.bAuthRestoreConnectPending=!1,this.bFocusOut=!1,this.bDeletedAnonymousInAuthSession=!1,this.bConfiguringConnection=!1,this.pJWTResolve="",this.pJWTReject="",this.onChatEnded=this.onChatEnded.bind(this),this.healthCheckInterval="",this.healthCheckIntervalTimer=32e3,this.wsErrorInterval="",this.bAgentTypingTimeout=!1,this.bEnableExponentialTimer=!1,this.healthCheckMultiplier=1.2,this.maximumTimerThreshold=3e5,this.iOnFocusReconnection=1300,this.bMobile=Object(p.w)(),this.sOS=Object(p.k)().os||"",this.nRAutoStartStartTime="",this.nRAutoStartEndTime="",this.oCustomAttributes={},this.bNewSession=!1,this.onWebSocketMessage=this.onWebSocketMessage.bind(this),this.onUploadProgress=this.onUploadProgress.bind(this),this.getWebSocketData=this.getWebSocketData.bind(this),this.closeWebSocket=this.closeWebSocket(this),this.makeRequest=this.makeRequest.bind(this),this.uploadRequest=this.uploadRequest.bind(this),this.cancelRequest=this.cancelRequest.bind(this),this.refreshAuthToken=this.refreshAuthToken.bind(this),this.onLogout=this.onLogout.bind(this),this.getCustomAttributes=this.getCustomAttributes.bind(this),this.pClearResolve="",this.pClearReject="",this.pClearMessengerResolve="",this.pClearMessengerReject="",this.iMaxCustomAttributesSize="",this.pStepUpConversationResolve="",this.pStepUpConversationReject="",k.init(this);var r=this;window.addEventListener("beforeunload",(function(e){r.getWebSocketData().then((function(t){if(t.isOpened){var n={token:r.getCustomerJourneyId()||r.config.token,action:"closeSession"};r.sendOverSocket(n),r.healthCheckInterval&&clearInterval(r.healthCheckInterval),r.closeWebSocket({code:-1}),r.bWebSocket=!1,setTimeout((function(){r.connect().then((function(e){var t=(e||{}).newSession;"boolean"!=typeof t||t||(r.pageNumber=1,r.fetchJWT())}))}),800),delete e.returnValue}}))})),window.addEventListener("focus",(function(e){setTimeout((function(){o.bFocusOut&&("iOS"===o.sOS||"Windows"===o.sOS||"Linux"===o.sOS||"Android"===o.sOS&&!o.aUploadQueue.length)&&o.closeWebSocketMobile()}),o.iOnFocusReconnection)})),window.addEventListener("blur",(function(){o.bFocusOut=!0}));var a=null;void 0!==document.visible?a="visibilitychange":void 0!==document.msHidden?a="msvisibilitychange":void 0!==document.webkitHidden&&(a="webkitvisibilitychange"),document.addEventListener(a,(function(){var e=r.config||{},t=e.conversationDisconnect,n=e.allowSessionUpgrade,o=t||{},u=o.enabled,s=o.type,i=u&&s&&s.toLowerCase()===f.DISCONNECT_TYPE_READONLY&&r.bConversationDisconnectEvent||!1;"visible"===document.visibilityState?(r.config.authEnabled&&r.bConnectionAutoClosed&&(r.bWebSocket||r.getTokens(r.aAuthTokenKeys).then((function(e){e[r.aAuthTokenKeys[0]]&&"undefined"!==e[r.aAuthTokenKeys[0]]||(k.resetConversation(),r.bLoggedOutEvent&&(r.onLogout({implicit:!0,keepIdentifiers:!!n}),r.bLoggedOutEvent=!1))}))),i&&(r.healthCheckIntervalTimer=32e3,k.resetHealthCheckInterval())):"hidden"===document.visibilityState&&i&&r.healthCheckInterval&&(clearInterval(r.healthCheckInterval),r.healthCheckInterval="")}))}),[{key:"closeWebSocketMobile",value:function(){var e=this,t=this;t.getWebSocketData().then((function(n){if(n.isOpened&&!e.bReconnecting&&e.bSessionActive&&e.bWebSocket&&e.bMobile&&(window.navigator||{}).onLine){var o={token:t.getCustomerJourneyId()||t.config.token,action:"closeSession"};t.sendOverSocket(o),t.healthCheckInterval&&clearInterval(t.healthCheckInterval),t.closeWebSocket({code:1e3,reason:"reconnecting"}),e.bWebSocket=!1,e.bFocusOut?(e.bFocusOut=!1,t.reconnect({state:"focusBack"})):t.reconnect()}}),(function(e){}))}},{key:"configure",value:function(e){if(e&&"object"==s()(e)){var t=e.messagingEndpoint,n=e.apiEndpoint,o=e.deploymentId,u=e.mode,r=e.auth,i=e.email,a=e.phoneNumber,D=e.firstName,c=e.lastName,l=e.version,d=void 0===l?"v1":l,p=e.customProperties,f=e.autoStart,E=e.conversationDisconnect,g=e.conversationClear,C=e.headlessMode,v=(f||{}).enabled;if(t&&"string"==typeof t&&(this.config.endPoint=t+"/"+d+"?deploymentId="+o+"&application="+"".concat(h.name,"-").concat(h.version)),n&&"string"==typeof n&&(this.config.apiEndpoint=n),o&&"string"==typeof o&&(this.config.deploymentId=o),u&&"number"==typeof u&&(this.config.mode=u),D&&"string"==typeof D&&(this.config.reservedFields.firstName=D),c&&"string"==typeof c&&(this.config.reservedFields.lastName=c),a&&"string"==typeof a&&(this.config.reservedFields.phoneNumber=a),i&&"string"==typeof i&&(this.config.reservedFields.email=i),p&&"object"==s()(p)&&(this.config.customProperties=p),v&&"boolean"==typeof v&&(this.config.bAutoStartEnabled=v),E&&"object"==s()(E)&&(this.config.conversationDisconnect=E),"boolean"==typeof C&&(this.config.headlessMode=C),r&&"object"==s()(r)){var m=r.enabled,b=r.allowSessionUpgrade;m&&"boolean"==typeof m&&(this.config.authEnabled=m,b&&"boolean"==typeof b&&(this.config.allowSessionUpgrade=b),m&&(this.config.mode=2))}g&&"object"==s()(g)&&(this.config.conversationClear=g),this.config.token=y()}}},{key:"sendGetConfiguration",value:function(){var e=this,t=this.config.authEnabled;if(e.bWebSocket){var n={deploymentId:e.config.deploymentId,token:e.getCustomerJourneyId()||e.config.token,mode:e.config.mode};if(!t||!0!==t)return n.action=f.GET_CONFIGURATION,e.sendOverSocket(n);e.bAuthenticating=!0,e.getTokens(e.aAuthTokenKeys).then((function(t){return n.action=f.GET_CONFIGURATION,n.data={code:t[e.aAuthTokenKeys[0]]},e.sendOverSocket(n)}))}}},{key:"stepUpConversation",value:function(){var e=this.config,t=e.authEnabled,n=e.allowSessionUpgrade,o=this;return new Promise((function(e,u){t&&n?o.getTokens(o.aAuthTokenKeys).then((function(t){var n=t[o.aAuthTokenKeys[0]];if(n&&"undefined"!==n)if(o.bWebSocket&&o.bSessionActive&&o.bAnonymousSession||o.bRestoring||o.bPreviousAuthSessionDetected){o.pStepUpConversationResolve=e,o.pStepUpConversationReject=u,o.bUpgradingSession=!0;var s=A(A({deploymentId:o.config.deploymentId,action:f.CONFIGURE_AUTH_SESSION,token:o.getCustomerJourneyId()||o.config.token,mode:o.config.mode,data:{code:t[o.aAuthTokenKeys[0]]}},o.config.reservedFields),{},{customProperties:o.config.customFields,stepUp:!0});o.oJourneyContext?s.journeyContext=o.oJourneyContext:s.journeyContext=A(A({},s.journeyContext),o.getJourneyContext()),o.sendOverSocket(s)}else u("There is no active conversation found to upgrade");else u("No auth tokens found to upgrade conversation")})):u("Upgrade to authenticated conversation must be enabled in your configuration")}))}},{key:"configureConnection",value:function(e,t){var n=this;t&&(n.customSettings=t);var o=this.config,u=o.authEnabled,s=o.allowSessionUpgrade,r=(e||{}).deleteAnonymous;if(n.bWebSocket){n.bConfiguringConnection=!0;var i=A(A({deploymentId:n.config.deploymentId,token:n.getCustomerJourneyId()||n.config.token,mode:n.config.mode},n.config.reservedFields),{},{customProperties:n.config.customFields});if(n.oJourneyContext?i.journeyContext=n.oJourneyContext:i.journeyContext=A(A({},i.journeyContext),n.getJourneyContext()),e&&Object.keys(e).length)(e||{}).startNew&&(i.startNew=!0);if(!u||!0!==u)return i.action=f.CONFIGURE_SESSION,n.sendOverSocket(i);r&&(n.bDeletedAnonymousInAuthSession=!0,n.removeSessionActiveStorage(),n.onDeleteAnonymousInAuthSession()),n.bAuthenticating=!0,n.getTokens(n.aAuthTokenKeys).then((function(e){var t=e[n.aAuthTokenKeys[0]];return t&&"undefined"!==t||!s?(n.bSessionActive&&n.bAnonymousSession&&(n.bUpgradingSession=!0),i.action=f.CONFIGURE_AUTH_SESSION,i.data={code:e[n.aAuthTokenKeys[0]]},n.sendOverSocket(i)):(n.bAuthenticating=!1,n.bAnonymousSession=!0,n.bUpgradedSession=!1,i.action=f.CONFIGURE_SESSION,n.sendOverSocket(i))}))}}},{key:"onWebSocketMessage",value:function(e){var t=this,n=k.transport,o=(t.oAuthHeadlessSettings||{}).configureOnly,u=n.config,s=u.bAutoStartEnabled,r=u.conversationDisconnect,i=u.authEnabled,a=u.headlessMode,D=u.allowSessionUpgrade,c=r||{},l=c.enabled,d=c.type,p=l&&d&&d.toLowerCase()===f.DISCONNECT_TYPE_READONLY&&t.bConversationDisconnectEvent||!1;if(e){var h=e.code,E=e.message,g=e.body,C=e.class,v=e.type,m=e.tracingId,b=g||{},F=b.errorCode,y=b.newSession,S=b.type,T=b.events,I=b.readOnly,w=b.allowedMedia,R=b.connected,B=b.maxCustomDataBytes,O=b.clearedExistingSession,x=b.authenticated,M=F||h,N=(w||{}).inbound||{},U=N.fileTypes,_=N.maxFileSizeKB,j=!1,P=[];if(U&&U.length&&U.forEach((function(e){var t=(e||{}).type;P.push(t)})),B&&(this.iMaxCustomAttributesSize=B),t.healthCheckInterval&&t.healthCheck(),t.bFetchingConfiguration)return P&&P.length&&(n.aAllowedFileTypes=P),_&&(n.maxFileSizeKB=_),n.onAllowedFileTypesUpdated(g),t.bFetchingConfiguration=!1,t.connecting=!1,n.closeWebSocket({code:1e3,reason:"fetched configuration"}),k.resolveConnectingPromise(),t.bWebSocket=!1,void(t.aMessageQueue.length&&t.sendMessage());g&&C&&"SessionResponse"===C&&"boolean"==typeof R&&!0===R&&(n.aAllowedFileTypes=P,_&&(n.maxFileSizeKB=_),n.onAllowedFileTypesUpdated(g)),t.bNewSession=y,y&&!0===t.bRestoring&&(t.onRestoreFailed(e),t.bRestoring=!1),"boolean"==typeof I&&!0===t.bRestoring&&t.onReadOnlySession({readOnly:I,originalData:e}),y&&(t.bNewConversation=!0,t.bConversationDisconnectEvent=!1,setTimeout((function(){t.bDeletedAnonymousInAuthSession=!1}),6e3)),t.bDeletedAnonymousInAuthSession&&!y&&(t.onCheckActiveTokensAndRestore(),t.bDeletedAnonymousInAuthSession=!1),y&&this.bClosedUnexpectedly&&(this.bClosedUnexpectedly=!1,t.aUploadQueue=[],t.onSessionExpired({errorKey:f.SESSION_EXPIRED}));var L=E||g;if(v&&"response"==v&&C&&"StructuredMessage"==C&&(j=!0,t.bEnableExponentialTimer&&M&&200==M&&k.resetHealthCheckInterval()),m&&(L=A(A({},L),{},{tracingId:m})),S&&"Event"==S&&M&&200==M?T&&T.length&&T.forEach((function(e){var o=e||{},u=o.eventType,s=(o.presence||{}).type;if(u&&u==f.PRESENCE_EVENT_TYPE&&s&&s==f.JOIN_EVENT){n.onReadyToSend(),t.bPresenceEvent=!0,t.nRAutoStartEndTime=(new Date).getTime();var r=t.nRAutoStartEndTime-t.nRAutoStartStartTime;t.nRMessengerPerformanceMetrics.autoStart({context:{totalLoadTime:r},attributes:{autoStart:r}})}})):s&&"boolean"==typeof y&&!y&&(t.bPresenceEvent=!0),t.bSessionActive)switch(M){case 200:case 201:case 202:t.connecting&&(t.connecting=!1),"string"==typeof L&&(L=JSON.parse(L)),t.bAnonymousSession&&t.bUpgradingSession&&"SessionResponse"===C&&g.connected&&(t.bUpgradedSession=!0,t.bUpgradingSession=!1,t.bAnonymousSession=!1,t.pStepUpConversationResolve&&O&&x&&(t.bPreviousAuthSessionDetected=!1,t.pStepUpConversationResolve(g),setTimeout((function(){t.pStepUpConversationResolve="",t.pStepUpConversationReject=""}),200)),t.pAuthRestoreConnectResolve&&(t.pAuthRestoreConnectResolve(g),t.pAuthRestoreConnectResolve=""),t.onConversationSteppedUp(g)),k.parseTranscript(L,C,j,e);break;case 500:case 502:case 503:case 504:case 404:t.pJWTReject&&(t.pJWTReject(g),t.pJWTReject=""),t.pStepUpConversationReject&&(t.pStepUpConversationReject(g),setTimeout((function(){t.pStepUpConversationResolve="",t.pStepUpConversationReject=""}),200)),k.handleErrorr(e);break;case 403:m&&t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),t.bAuthenticating?(t.pJWTReject&&(t.pJWTReject(g),t.pJWTReject=""),k.handleErrorr(e)):(t.healthCheckInterval&&(clearInterval(t.healthCheckInterval),t.healthCheckInterval=""),t.closeWebSocket({code:1e3,reason:"TOKEN_IS_EXPIRED"}),t.reAuthenticate().then((function(){t.connect()})));break;case 401:case 400:t.bAuthenticating?(t.bAuthenticating=!1,t.refreshAuthToken().then((function(e){t.connect()})).catch((function(e){}))):(t.pJWTReject&&(t.pJWTReject(g),t.pJWTReject=""),k.handleErrorr(e));break;case 409:t.aUploadQueue=[],e.errorKey=t.errorCodes[M],m&&t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),t.bEnableExponentialTimer&&(t.healthCheckIntervalTimer=32e3),n.healthCheckInterval&&(clearInterval(n.healthCheckInterval),n.healthCheckInterval=""),t.bConfiguringConnection&&D&&p&&t.resetIdentifiers().then((function(){k.resetConversation(),t.aUploadQueue=[],setTimeout((function(){t.configureConnection({deleteAnonymous:!0})}),800)}));break;case 429:t.aUploadQueue=[],e.errorKey=t.errorCodes[M],m&&t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)});break;case 4004:case 4005:case 4e3:case 4001:case 4002:case 4003:case 4102:case 4011:t.aUploadQueue=[],e.errorKey=t.errorCodes[M],k.handleErrorr(e);break;case 4006:case 4007:t.aUploadQueue=[],t.aTransformedMessages=[],t.oMessages={},t.aAttachmentIds=[],t.oCustomAttributes={},t.bEnableExponentialTimer&&(t.healthCheckIntervalTimer=32e3),t.healthCheckInterval&&(clearInterval(t.healthCheckInterval),t.healthCheckInterval=""),t.bConversationDisconnectEvent?t.onConversationNotFound(e):t.bConnectionAutoClosed||t.onSessionExpired(e),k.closeWebSocket();break;case 4012:t.oLastMessageSent&&Object.keys(t.oLastMessageSent).length&&t.aMessageQueue.push(t.oLastMessageSent),t.oLastMessageSent={},t.connecting||t.connect();break;case 4013:e.errorKey=t.errorCodes[M],t.iMaxCustomAttributesSize&&(e.body=f.CUSTOM_ATTRIBUTES_SIZE_EXCEEDED_MESSAGE+" "+t.iMaxCustomAttributesSize+" bytes"),k.handleErrorr(e);break;case 4016:t.bUpgradingSession&&(e.errorKey=t.errorCodes[M],t.authSessionAlreadyExists(e),t.bUpgradingSession=!1);break;case 4017:t.resetIdentifiers().then((function(){t.configureConnection()}))}else if(M&&200===M){if(l&&this.bCloseSession&&"boolean"==typeof R&&!R&&(k.closeWebSocket(),this.bResetConversation))return this.bResetConversation=!1,k.resetConversation(),void t.resetConversation();if(t.bSessionActive=!0,t.bConnectionAutoClosed=!1,t.bLoggedOutEvent=!1,t.bReconnecting)t.bReconnecting=!1,t.onReconnected(e),y&&(t.onChatStarted({authenticated:D?x||t.bUpgradedSession:t.config.authEnabled,readOnly:I}),s&&(t.bReadyToSendJoinEvent||(t.bReadyToSendJoinEvent=!0))),t.aMessageQueue.length&&t.sendMessage(),t.aUploadQueue.length&&t.requestFileUpload(),t.aGetFileQueue.length&&t.getFile(),t.aRefreshFilesQueue.length&&t.refreshFiles(),t.aDeleteFileQueue.length&&t.deleteFile(),t.healthCheck();else{if(t.connecting=!1,t.onChatStarted({authenticated:D?x||t.bUpgradedSession:t.config.authEnabled,readOnly:I}),y&&s){var W={type:"autoStart"};t.bReadyToSendJoinEvent||(t.bReadyToSendJoinEvent=!0,t.bPendingSendJoinEvent&&(t.sendMessage(t.oTempJoinEvent),t.bPendingSendJoinEvent=!1,t.oTempJoinEvent="",t.onPendingJoinEventSent())),a&&!o?t.sendMessage(W):i||t.sendMessage(W)}t.aMessageQueue.length&&t.sendMessage(),t.aUploadQueue.length&&t.requestFileUpload(),t.aGetFileQueue.length&&t.getFile(),t.aRefreshFilesQueue.length&&t.refreshFiles(),t.aDeleteFileQueue.length&&t.deleteFile(),t.healthCheck()}t.bAuthenticating=!1,t.bUpgradingSession&&"SessionResponse"===C&&g.connected&&(t.bUpgradedSession=!0,t.bUpgradingSession=!1,t.bAnonymousSession=!1,t.pStepUpConversationResolve&&O&&(t.bPreviousAuthSessionDetected=!1,t.pStepUpConversationResolve(g),setTimeout((function(){t.pStepUpConversationResolve="",t.pStepUpConversationReject=""}),200)),t.onConversationSteppedUp(g)),t.pConnectResolve&&(t.pConnectResolve(g),t.pConnectResolve=""),t.pRestoreConnectResolve&&(t.pRestoreConnectResolve(g),t.pRestoreConnectResolve=""),t.pAuthRestoreConnectResolve&&(t.pAuthRestoreConnectResolve(g),t.pAuthRestoreConnectResolve=""),t.pReconnectResolve&&(t.pReconnectResolve(),t.pReconnectResolve="")}else{switch(M){case 401:t.bAuthenticating&&(t.bAuthenticating=!1,t.connecting=!1,t.closeWebSocket({code:1e3,reason:"TOKEN_IS_EXPIRED"}),t.removeOpenStorage(),t.refreshAuthToken({restore:!0}).then((function(){})).catch((function(){})));break;case 400:t.bAuthenticating&&(t.bAuthenticating=!1,t.connecting=!1,t.refreshAuthToken({restore:!0}).then((function(){})).catch((function(){})));break;case 403:e.errorKey=t.errorCodes[M],m&&t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),t.bAuthenticating=!1,t.healthCheckInterval&&(clearInterval(t.healthCheckInterval),t.healthCheckInterval=""),t.removeOpenStorage(),t.closeWebSocket({code:1e3,reason:"TOKEN_IS_EXPIRED"}),t.reAuthenticate().then((function(e){t.connect()}));break;case 4016:e.errorKey=t.errorCodes[M],t.bPreviousAuthSessionDetected=!0,t.authSessionAlreadyExists(e),t.bUpgradingSession=!1;break;case 409:t.bEnableExponentialTimer&&(t.healthCheckIntervalTimer=32e3),n.healthCheckInterval&&(clearInterval(n.healthCheckInterval),n.healthCheckInterval=""),t.bConfiguringConnection&&D&&t.resetIdentifiers().then((function(){k.resetConversation(),t.aUploadQueue=[],setTimeout((function(){t.configureConnection({deleteAnonymous:!0})}),800)}));break;case 4017:t.resetIdentifiers().then((function(){t.configureConnection()}));break;default:t.connecting=!1,t.bReconnecting=!1,t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)})}t.pConnectReject&&(t.pConnectReject(),t.pConnectReject=""),t.pReconnectReject&&(t.pReconnectReject(),t.pReconnectReject="")}t.bConfiguringConnection=!1}}},{key:"onWebSocketError",value:function(e){var t=this,n=(window.navigator||{}).onLine;this.wsErrorInterval&&clearInterval(this.wsErrorInterval),this.wsErrorInterval="","iOS"===this.sOS&&n?(this.wsErrorInterval=setInterval((function(){t.bReconnecting&&(t.wsErrorInterval&&clearInterval(t.wsErrorInterval),t.wsErrorInterval="")}),200),setTimeout((function(){t.wsErrorInterval&&(clearInterval(t.wsErrorInterval),t.wsErrorInterval="",k.handleErrorr(e))}),2e3)):k.handleErrorr(e)}},{key:"onWebSocketClose",value:function(e){var t=e.code,n=e.reason;this.bSessionActive=!1;var o=(window.navigator||{}).onLine,u=this.config||{},s=u.allowSessionUpgrade,r=u.authEnabled;if(this.bWebSocket=!1,this.bEnableExponentialTimer&&(this.healthCheckIntervalTimer=32e3),this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=""),!n||!r||"TOKEN_IS_EXPIRED"!==n){if(!n||"clearMessenger"!==n)return n&&r&&s&&"deletedAnonymousInAuthSession"===n?(k.resetConversation(),void(this.aUploadQueue=[])):void(t&&-1!==this.aUnexpectedSocketCloseCodes.indexOf(t)&&!this.bConnectionAutoClosed?(this.bClosedUnexpectedly=!0,o&&this.reconnect()):r&&(this.bConnectionAutoClosed||(this.bLoggedOutEvent?(this.onLogout({implicit:!0,keepIdentifiers:!!s}),this.bLoggedOutEvent=!1):(k.resetConversation(),"logout"===n&&this.onLogout(e)))));"function"==typeof this.pClearMessengerResolve&&(this.pClearMessengerResolve(e),this.pClearMessengerResolve="")}}},{key:"onUploadProgress",value:function(e){var t=e.percentage;e.loaded,e.total;this.bUploading=!0,this.onFileUploading({percentage:t})}},{key:"onChatStarted",value:function(e){}},{key:"onMessageReceived",value:function(e){}},{key:"onMessageSent",value:function(e){}},{key:"onTypingReceived",value:function(e){}},{key:"onTypingTimeout",value:function(){}},{key:"onReadyToSend",value:function(){}},{key:"onUploadApproved",value:function(e){}},{key:"onFileUploaded",value:function(){}},{key:"onFileDeleted",value:function(e){}},{key:"onError",value:function(e){}},{key:"onConnectError",value:function(){}},{key:"onSessionExpired",value:function(e){}},{key:"onChatEnded",value:function(e){}},{key:"onReconnecting",value:function(e){}},{key:"onReconnected",value:function(e){}},{key:"onConnectionClosed",value:function(){}},{key:"onOutofOrderMessageReceived",value:function(){}},{key:"onPendingJoinEventSent",value:function(){}},{key:"onDeleteAnonymousInAuthSession",value:function(){}},{key:"onCheckActiveTokensAndRestore",value:function(){}},{key:"openWebSocket",value:function(e){}},{key:"closeWebSocket",value:function(e){}},{key:"sendOverSocket",value:function(e){}},{key:"getWebSocketData",value:function(){}},{key:"makeRequest",value:function(e){}},{key:"uploadRequest",value:function(e){}},{key:"cancelRequest",value:function(){}},{key:"onAllowedFileTypesUpdated",value:function(e){}},{key:"refreshAuthToken",value:function(){}},{key:"reAuthenticate",value:function(){}},{key:"onLogout",value:function(e){}},{key:"onConversationSteppedUp",value:function(e){}},{key:"authSessionAlreadyExists",value:function(e){}},{key:"onConversationAuthenticated",value:function(e){}},{key:"resetIdentifiers",value:function(){}},{key:"getCustomAttributes",value:function(e){}},{key:"getCustomerJourneyId",value:function(){}},{key:"getCustomerSessionId",value:function(){}},{key:"getJourneyContext",value:function(){}},{key:"resetConversation",value:function(){}},{key:"removeOpenStorage",value:function(){}},{key:"removeSessionActiveStorage",value:function(){}},{key:"getConfiguration",value:function(e){var t=this.config.endPoint,n=(e||{}).token,o=this;return new Promise((function(u,s){if(n&&(o.config.token=e.token),t&&!o.connecting){o.connecting=!0;try{o.openWebSocket({endPoint:t}).then((function(t){return o.bWebSocket=!0,o.bFetchingConfiguration=!0,u(t),o.sendGetConfiguration(e||{})})).catch((function(e){o.bFetchingConfiguration=!1,o.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),s(e)}))}catch(e){o.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),o.bFetchingConfiguration=!1,o.bWebSocket=!1,s(e)}}else o.onError(),s()}))}},{key:"startConversation",value:function(e,t){var n=this,o=this.config.endPoint,u=(e||{}).journeyContext,s=this;return new Promise((function(r,i){if(s.oJourneyContext=u&&Object.keys(u).length?u:s.getJourneyContext(),e.token&&(s.config.token=e.token),t&&(s.customSettings=t),!o||s.connecting||s.bWebSocket)n.bFetchingConfiguration?(e&&n.aMessageQueue.push(e),r()):s.connecting||s.bWebSocket||(s.onError(),i());else{s.connecting=!0,s.bNewConversation=!0;try{s.openWebSocket({endPoint:o}).then((function(n){return s.bWebSocket=!0,r(n),s.configureConnection(e||{},t)})).catch((function(e){s.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),i(e)}))}catch(e){s.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),s.bWebSocket=!1,i(e)}}}))}},{key:"connect",value:function(){var e=this.config.endPoint,t=this;return new Promise((function(n,o){t.bWebSocket?(t.onConnectError(),o({error:"Connection already exists",code:f.ALREADY_CONNECTED})):t.connecting?t.bRestoreConnectPending?t.pRestoreConnectResolve||(t.pRestoreConnectResolve=n):t.bAuthRestoreConnectPending?t.pAuthRestoreConnectResolve||(t.pAuthRestoreConnectResolve=n):n():(t.bSessionActive=!1,t.connecting=!0,t.bNewConversation=!1,t.pConnectResolve=n,t.pConnectReject=o,t.openWebSocket({endPoint:e}).then((function(){t.bWebSocket=!0,t.connecting=!1,t.getWebSocketData().then((function(e){e.isOpened&&t.configureConnection()}))})).catch((function(e){t.bWebSocket=!1,t.connecting=!1,t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),o(e)})))}))}},{key:"reconnect",value:function(e){var t=this,n=this.config.endPoint,o=(e||{}).state,u=this,s=!0,r=!1;return o&&"backOnline"===o&&this.bConnectionAutoClosed&&(s=!1),o&&"focusBack"===o&&!this.bConnectionAutoClosed&&(r=!0),new Promise((function(e,i){u.pReconnectResolve=e,u.pReconnectReject=i,s?u.getWebSocketData().then((function(s){var a=s.isOpened,D=s.isClosed,c=s.isClosing;a&&(t.bMobile&&o&&"backOnline"===o?(u.closeWebSocketMobile(),e()):(u.onReconnected(),u.healthCheck(),u.aMessageQueue.length&&u.sendMessage(),e())),(D||c)&&(u.bSessionActive=!1,u.bReconnecting=!0,r||u.onReconnecting(),u.openWebSocket({endPoint:n}).then((function(){u.bWebSocket=!0,u.configureConnection(),e()})).catch((function(e){u.connecting=!1,u.bReconnecting=!1,u.bWebSocket=!1,u.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}),i&&i(e)})))})):(i("Limited connections are allowed"),u.pReconnectResolve="",u.pReconnectReject="")}))}},{key:"fetchJWT",value:function(){var e=this;return new Promise((function(t,n){e.getJWT().then((function(o){var u=(o||{}).jwt;u&&k.restoreRequest(u).then((function(e){t(e)}),(function(t){clearInterval(e.healthCheckInterval),n(t)}))}),(function(e){n(e)}))}))}},{key:"restore",value:function(e){var t=this,n=(e||{}).type,o=this.config,u=o.authEnabled,s=o.allowSessionUpgrade;return this.bNewConversation=!1,this.bRestoring=!0,n&&"backOnline"===n&&k.resetConversation(n),new Promise((function(e,n){t.bSessionActive&&t.bWebSocket?e(t.fetchJWT()):(t.bRestoreConnectPending=!0,t.connect().then((function(n){var o=(n||{}).newSession;t.bRestoreConnectPending=!1,"boolean"!=typeof o||o?s&&u&&e(t.fetchJWT()):e(t.fetchJWT())}),(function(e){var n=(e||{}).code;t.bRestoreConnectPending=!1,n&&n===f.ALREADY_CONNECTED?t.fetchJWT():(t.healthCheckInterval&&(clearInterval(t.healthCheckInterval),t.healthCheckInterval=""),t.bPreviousAuthSessionDetected||t.onError({originalError:e,formattedError:k.sanitiseMessage(e,!0)}))})))}))}},{key:"restoreAuthSession",value:function(e){var t=this,n=(e||{}).resetConversation,o="",u="";t.oAuthHeadlessSettings=e,this.bNewConversation=!1;var s=new Promise((function(e,s){var r=function(){t.connect().then((function(n){t.bAuthRestoreConnectPending=!1,(n||{}).newSession?e():e(t.fetchJWT())}),(function(n){var o=(n||{}).code;o&&o===f.ALREADY_CONNECTED&&t.bSessionActive?(t.bAuthRestoreConnectPending=!1,e(t.fetchJWT())):t.bDeletedAnonymousInAuthSession&&t.bAuthenticating?u=setInterval((function(){t.bSessionActive&&(clearInterval(u),t.bAuthRestoreConnectPending=!1,t.bDeletedAnonymousInAuthSession=!1,e(t.fetchJWT()))}),500):(t.bAuthRestoreConnectPending=!1,t.healthCheckInterval&&(clearInterval(t.healthCheckInterval),t.healthCheckInterval=""))}))};t.bSessionActive&&t.bWebSocket?e(t.fetchJWT()):(t.bAuthRestoreConnectPending=!0,n&&k.resetConversation(),t.connecting?o=setInterval((function(){t.connecting||(clearInterval(o),r())}),500):r())}));return s}},{key:"fetchHistory",value:function(){var e=this;return this.bNewConversation=!1,this.bRestoring=!0,new Promise((function(t,n){e.getJWT().then((function(o){var u=(o||{}).jwt;if(u)if(e.bNewConversation)t();else{var s=k.buildHistoryURL()+"?pageNumber="+e.pageNumber;e.makeRequest({url:s,method:"get",headers:{Authorization:"Bearer ".concat(u)}}).then((function(n){var o=n.data,u=n.status;u&&200===u&&k.formatMessages(o).then((function(n){n&&n.length&&e.pageNumber++,t({messages:n,pageNumber:o.pageNumber,pageSize:o.pageSize})})).catch((function(){}))})).catch((function(t){var o=((t.response||t).data||"").code,u={errorKey:o||""};o&&-1!==e.httpSessionErrorCodes.indexOf(o)&&(u.errorKey=f.SESSION_EXPIRED,e.aUploadQueue=[],e.onSessionExpired(u)),o&&-1!==e.httpJWTExpiryCodes.indexOf(o)?e.bSessionActive&&e.onTokenExpired({code:f.UNAUTHORIZED,commandName:"fetchHistory",error:t}):n("Unable to restore",t)}))}}),(function(t){e.onFetchHistoryFailed(t),n(t)}))}))}},{key:"sendEcho",value:function(e){this.bSessionActive&&!this.bConnectionAutoClosed&&this.sendOverSocket({action:f.SEND_ECHO,message:{type:"Text",text:e&&e.text?e.text:""}})}},{key:"getJWT",value:function(){var e=this;return e.bSessionActive?new Promise((function(t,n){e.pJWTResolve=t,e.pJWTReject=n;var o={action:f.GET_JWT,token:e.getCustomerJourneyId()||e.config.token};e.sendOverSocket(o)})):new Promise((function(e,t){e()}))}},{key:"setPendingJoinEvent",value:function(e){this.bPendingSendJoinEvent=!0,this.oTempJoinEvent=e}},{key:"sendMessage",value:function(e,t){if(this.bWebSocket){var n=this,o=this.sAttachmentId,u=this.aUploadQueue,s=this.config,r=this.bReadyToSendJoinEvent,i=((s||{}).authEnabled,t||!1),a=(this.customSettings||{}).configureOnly,D=!!o&&u&&u.length&&!u[0].sent;this.bSessionActive&&!i?(e&&this.aMessageQueue.push(e),this.aMessageQueue.map((function(e,t){var u=y(),s=y(),i={action:f.SEND_MESSAGE,token:n.getCustomerJourneyId()||n.config.token,tracingId:s,message:{metadata:{id:u}}};if(e&&e.message&&(i.message.type="Text",i.message.text=e.message),D){var c={contentType:"Attachment",attachment:{id:o}};i.message.content=i.message.content||[],i.message.content.push(c)}if(e&&e.type){(e.postback||"").text;var l=("autoStart"!=e.type?Object(p.z)(e.postback.text,n.maxMessageSize):"").text;switch(e.type){case"quickReply":i.message.type="Structured",i.message.text=l,i.message.content=[{contentType:"ButtonResponse",buttonResponse:{type:"QuickReply",text:l,payload:e.postback.payload}}];break;case"autoStart":var d=!1;a?r&&(d=!0):d=!0,d&&(i.message.type="Event",i.message.events=[{eventType:"Presence",presence:{type:"Join"}}]);break;case"card":i.message.type="Structured",i.message.text=l,i.message.content=[{contentType:"ButtonResponse",buttonResponse:{type:"Button",text:l,payload:e.postback.payload}}];break;case"cobrowse":i.message.type="Event",i.message.content=[],i.message.events=[{eventType:"CoBrowse",coBrowse:e.postback.payload}];break;case"clear":i.message.type="Event",i.message.content=[],i.message.events=[{eventType:"Presence",presence:{type:"Clear"}}]}}n.getCustomAttributes().then((function(t){var o=((t||{}).messaging||{}).customAttributes;o&&Object.keys(o).length&&(i.message.channel={metadata:{customAttributes:o}}),e&&e.type&&"autoStart"==e.type&&(n.nRAutoStartStartTime=(new Date).getTime()),(i.message.type||i.message.content)&&(n.sendOverSocket(i),n.onMessageSent(A(A({},i.message),{},{tracingId:i.tracingId})))})),n.bEnableExponentialTimer&&k.resetHealthCheckInterval(),e&&Object.keys(e).length&&(n.oLastMessageSent=e),t===n.aMessageQueue.length-1&&(n.aMessageQueue=[]),D&&(n.aUploadQueue[0].sent=!0)}))):i||this.bReconnecting||this.connecting?this.aMessageQueue.push(e):(e&&this.aMessageQueue.push(e),this.reconnect())}else e&&this.aMessageQueue.push(e),this.connecting||this.connect()}},{key:"sendTyping",value:function(){if(this.bWebSocket){var e=this,t=k.transport.config.bAutoStartEnabled;if(t&&e.bPresenceEvent||!t)if(this.bSessionActive){var n={action:f.SEND_MESSAGE,token:e.getCustomerJourneyId()||e.config.token,message:{type:"Event",events:[{eventType:"Typing",typing:{type:"On"}}]}};e.sendOverSocket(n),e.bEnableExponentialTimer&&k.resetHealthCheckInterval()}else this.reconnect()}}},{key:"deleteFile",value:function(e){var t=this,n=e.id,o=this;this.aUploadQueue.map((function(e,u){e&&e.id==n&&(o.bWebSocket?o.bSessionActive?(o.aDeleteFileQueue.push(n),o.aUploadQueue.splice(u,1),o.sAttachmentId="",o.bUploading&&(o.bUploading=!1,o.cancelRequest(),o.onFileUploadCancelled(e)),o.aDeleteFileQueue.map((function(e){o.sendOverSocket({action:f.DELETE_ATTACHMENT,token:o.getCustomerJourneyId()||o.config.token,attachmentId:e})}))):t.bReconnecting||t.connecting?t.aDeleteFileQueue.push(n):t.reconnect():(t.aDeleteFileQueue.push(n),t.connect()))}))}},{key:"downloadFile",value:function(e){var t=e||{},n=t.downloadUrl,o=t.name,u=this,s=new Promise((function(e,t){if(n&&o)u.makeRequest({url:n,method:"get",responseType:"blob",Pragma:"no-cache",Expires:"0","Cache-Control":"no-cache",responseContentDisposition:"attachment"}).then((function(t){Object(d.saveAs)(new Blob([t.data],{type:t.data.type}),o),e(t)})).catch((function(e){u.onFileDownloadError({error:e});var n=e&&Object.keys(e).length&&e.toJSON()||{};u.onError({originalError:n,formattedError:k.sanitiseMessage(n,!0)}),t(e)}));else{var s="No attachment data available to download";u.onFileDownloadError({error:s}),u.onError({originalError:s,formattedError:k.sanitiseMessage(s,!0)}),t(s)}}));return s}},{key:"refreshFiles",value:function(e){var t=this,n=this,o=e||this.aRefreshFilesQueue;o&&o.forEach((function(e){var o=(e||{}).id;o&&(t.bWebSocket?t.bSessionActive?(o&&t.aRefreshFilesQueue.push(o),t.aRefreshFilesQueue.map((function(e){n.sendOverSocket({action:f.GET_ATTACHMENT,token:n.getCustomerJourneyId()||n.config.token,attachmentId:e})}))):t.bReconnecting||t.connecting?o&&t.aRefreshFilesQueue.push(o):t.reconnect():(o&&t.aRefreshFilesQueue.push(o),t.connect()))}))}},{key:"getFile",value:function(e){var t=e||{},n=t.id,o=t.attachmentId,u=n||o;if(u)if(this.bWebSocket){var s=this;this.bSessionActive?(u&&!this.aGetFileQueue.includes(u)&&this.aGetFileQueue.push(u),this.aGetFileQueue.map((function(e,t){s.sendOverSocket({action:f.GET_ATTACHMENT,token:s.getCustomerJourneyId()||s.config.token,attachmentId:e})}))):this.bReconnecting||this.connecting?u&&this.aGetFileQueue.push(u):this.reconnect()}else u&&this.aGetFileQueue.push(u),this.connect()}},{key:"requestFileUpload",value:function(e){if(this.bWebSocket){var t=this;this.bSessionActive?(e&&(e[0].sent=!1,this.aUploadQueue.push(e[0])),this.aUploadQueue.map((function(e,n){var o=!1;if(e.type&&""!==e.type){var u=e.type.toLowerCase();t.aDeprecatedFileTypes.includes(u)?o=!0:t.aDeprecatedFileTypes.includes(u)||(o=Object(p.A)(e.name,u))}t.sendOverSocket({action:f.SEND_ATTACHMENT,token:t.getCustomerJourneyId()||t.config.token,fileName:e.name,fileType:e.type&&""!==e.type&&!o?e.type:Object(p.r)(e.name),fileSize:e.size})}))):this.bReconnecting||this.connecting?e&&(e[0].sent=!1,this.aUploadQueue.push(e[0])):this.reconnect()}else e&&(e[0].sent=!1,this.aUploadQueue.push(e[0])),this.connect()}},{key:"endChat",value:function(e){if(this.bWebSocket){var t=(e||{}).deletedAnonymousInAuthSession,n={token:this.getCustomerJourneyId()||this.config.token,action:"closeSession"};this.bNewConversation=!0,clearInterval(this.healthCheckInterval),this.healthCheckInterval="",this.sendOverSocket(n),t?this.closeWebSocket({code:1e3,reason:"deletedAnonymousInAuthSession"}):this.config.authEnabled&&!t?this.closeWebSocket({code:1e3,reason:"logout"}):this.closeWebSocket()}}},{key:"clearSession",value:function(e){var t=(this.config.conversationDisconnect||{}).enabled,n=(e||{}).resetSession,o=this;if(this.bWebSocket){var u={token:this.getCustomerJourneyId()||this.config.token,action:f.DELETE_SESSION};n&&(this.bResetConversation=!0,u.closeAllConnections=!0),this.bNewConversation=!0,this.bWebSocket=!1,this.bRestoring=!1,this.pageNumber=1,this.oCustomAttributes={},this.bSessionActive=!1,clearInterval(this.healthCheckInterval),this.healthCheckInterval="",this.sendOverSocket(u).then((function(){o.bCloseSession=!0,t||k.closeWebSocket()}))}}},{key:"clearTypingTimeout",value:function(){this.bAgentTypingTimeout&&(clearTimeout(this.bAgentTypingTimeout),this.bAgentTypingTimeout=!1)}},{key:"healthCheck",value:function(){var e=this;clearInterval(this.healthCheckInterval),this.healthCheckInterval="",this.healthCheckInterval=setInterval((function(){e.getWebSocketData().then((function(t){t.isOpened&&e.sendEcho()}))}),this.healthCheckIntervalTimer)}},{key:"clearMessenger",value:function(){var e=this;return new Promise((function(t,n){var o=e;if(e.bWebSocket){o.pClearMessengerResolve=t,o.pClearMessengerReject=n;var u={token:e.getCustomerJourneyId()||e.config.token,action:f.DELETE_SESSION};e.bNewConversation=!0,clearInterval(e.healthCheckInterval),e.healthCheckInterval="",e.sendOverSocket(u).then((function(){o.bCloseSession=!0,e.closeWebSocket({code:1e3,reason:"clearMessenger"})}))}else t()}))}},{key:"clearConversation",value:function(){var e=this.config.conversationClear,t=(e||{}).enabled,n=((e||{}).enabled,this);return new Promise((function(e,o){if(t)if(n.bWebSocket&&n.bSessionActive){n.pClearResolve=e,n.pClearReject=o;var u={action:f.SEND_MESSAGE,token:n.getCustomerJourneyId()||n.config.token,message:{metadata:{id:y()},type:"Event",events:[{eventType:"Presence",presence:{type:"Clear"}}]}};n.sendOverSocket(u)}else o("There is no active conversation found to clear");else o("Please check your conversation clear option is enabled in your configuration")}))}}])}())},73:function(e,t,n){var o=n(74);e.exports=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},74:function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o},e.exports.__esModule=!0,e.exports.default=e.exports},78:function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},79:function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,u,s=[],r=!0,i=!1;try{for(n=n.call(e);!(r=(o=n.next()).done)&&(s.push(o.value),!t||s.length!==t);r=!0);}catch(e){i=!0,u=e}finally{try{r||null==n.return||n.return()}finally{if(i)throw u}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},8:function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},80:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}})}));